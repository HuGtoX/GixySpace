# 文档管理系统使用指南

## 📚 功能概述

文档管理系统是番茄工具箱的管理后台功能之一，用于浏览和管理项目中的Markdown文档。该系统提供了直观的界面来查看、搜索和预览docs目录下的所有技术文档。

## 🚀 快速开始

### 访问文档管理页面

1. 确保你已经以管理员身份登录
2. 访问 `/admin/docs` 路径
3. 系统会自动加载docs目录下的所有Markdown文档

### 主要功能

#### 1. 文档列表浏览

- **分类展示**：文档按照类别自动分组显示
- **统计信息**：顶部显示文档总数、分类数量、总大小和最近更新时间
- **文档卡片**：每个文档显示标题、描述、文件名、大小和修改时间

#### 2. 搜索功能

在搜索框中输入关键词，系统会实时搜索：

- 文档标题
- 文档描述
- 文件名

支持中英文搜索，搜索结果会即时更新。

#### 3. 分类筛选

使用分类下拉菜单可以快速筛选特定类别的文档：

- 快速开始
- API文档
- 使用指南
- 实现文档
- 功能总结
- 数据库
- 架构设计
- 其他

#### 4. 文档预览

点击文档卡片上的"预览"按钮，可以在弹窗中快速查看文档内容：

- 支持Markdown渲染
- 显示文档元信息
- 代码高亮显示
- 支持复制代码块

#### 5. 文档详情页

点击"查看详情"按钮或在预览窗口中点击"查看完整文档"，会在新标签页打开文档详情页：

- 完整的文档内容展示
- 右侧目录导航（自动提取文档标题）
- 面包屑导航
- 响应式布局

## 🎯 使用场景

### 场景1：查找特定功能的文档

1. 在搜索框输入功能关键词（如"上传"、"认证"等）
2. 系统会筛选出相关文档
3. 点击预览快速浏览内容
4. 找到目标文档后点击查看详情

### 场景2：浏览某个分类的所有文档

1. 点击分类下拉菜单
2. 选择目标分类（如"API文档"）
3. 系统会只显示该分类下的文档
4. 按需查看各个文档

### 场景3：查看最新更新的文档

1. 文档列表默认按修改时间倒序排列
2. 最新更新的文档会显示在前面
3. 顶部统计卡片显示最近更新时间

## 📖 技术实现

### 文件结构

```
src/
├── app/
│   ├── api/
│   │   └── docs/
│   │       └── route.ts          # API路由：读取文档
│   └── admin/
│       └── docs/
│           ├── page.tsx           # 文档列表页面
│           └── [slug]/
│               └── page.tsx       # 文档详情页面
└── components/
    └── ui/
        └── MarkdownRenderer.tsx   # Markdown渲染组件
```

### API接口

#### 获取文档列表

```typescript
GET / api / docs;
```

**查询参数：**

- `search`: 搜索关键词（可选）
- `category`: 分类筛选（可选）

**响应示例：**

```json
{
  "success": true,
  "data": {
    "docs": [
      {
        "slug": "upload-quick-start",
        "fileName": "upload-quick-start.md",
        "title": "快速开始：Supabase Storage 上传功能",
        "description": "5分钟快速上手上传功能",
        "category": "快速开始",
        "size": 9123,
        "modifiedTime": "2024-01-15T10:30:00.000Z"
      }
    ],
    "total": 40,
    "categories": ["快速开始", "API文档", "使用指南"]
  }
}
```

#### 获取单个文档内容

```typescript
GET /api/docs?slug=upload-quick-start
```

**响应示例：**

```json
{
  "success": true,
  "data": {
    "slug": "upload-quick-start",
    "fileName": "upload-quick-start.md",
    "title": "快速开始：Supabase Storage 上传功能",
    "content": "# 快速开始...",
    "category": "快速开始",
    "size": 9123,
    "modifiedTime": "2024-01-15T10:30:00.000Z"
  }
}
```

### 文档元数据提取

系统会自动从Markdown文件中提取以下信息：

1. **标题**：提取第一个 `#` 标题
2. **描述**：提取标题后的第一个段落
3. **分类**：根据标题关键词自动推断
4. **文件信息**：文件名、大小、修改时间

### 分类推断规则

系统根据文档标题中的关键词自动推断分类：

| 关键词                     | 分类     |
| -------------------------- | -------- |
| quick, 快速, start         | 快速开始 |
| api, 接口                  | API文档  |
| guide, 指南, 教程          | 使用指南 |
| implementation, 实现, 开发 | 实现文档 |
| summary, 总结              | 功能总结 |
| database, 数据库, schema   | 数据库   |
| architecture, 架构         | 架构设计 |
| 其他                       | 其他     |

## 🎨 界面特性

### 响应式设计

- **桌面端**：完整的三栏布局（导航、内容、目录）
- **平板端**：两栏布局（导航、内容）
- **移动端**：单栏布局，自适应屏幕宽度

### 深色模式支持

所有页面都支持深色模式，会自动跟随系统主题切换。

### 交互体验

- **悬停效果**：文档卡片悬停时显示背景色变化
- **加载状态**：数据加载时显示Spin组件
- **空状态**：无数据时显示友好的Empty组件
- **错误处理**：API错误时显示message提示

## 🔧 开发指南

### 添加新文档

1. 在 `docs/` 目录下创建新的 `.md` 文件
2. 使用标准的Markdown格式编写
3. 确保文档有清晰的标题（使用 `#` 标记）
4. 刷新文档管理页面即可看到新文档

### 文档命名规范

建议使用以下命名格式：

- 使用小写字母和连字符
- 描述性的文件名
- 例如：`feature-name-guide.md`、`api-endpoint-docs.md`

### 文档内容规范

1. **标题层级**：使用 `#` 到 `######` 表示不同层级
2. **代码块**：使用三个反引号包裹，并指定语言
3. **链接**：使用相对路径引用其他文档
4. **图片**：建议使用外部图床或项目public目录

### 扩展功能

如需添加更多功能，可以考虑：

1. **文档编辑**：添加在线编辑功能
2. **版本控制**：集成Git历史记录
3. **文档导出**：支持导出为PDF或其他格式
4. **协作功能**：添加评论和讨论功能
5. **全文搜索**：集成更强大的搜索引擎

## 📝 最佳实践

### 文档组织

1. **按功能分类**：相关的文档使用相似的命名前缀
2. **保持更新**：及时更新文档内容
3. **添加示例**：提供代码示例和使用场景
4. **交叉引用**：在文档间添加相关链接

### 性能优化

1. **文档大小**：单个文档建议不超过100KB
2. **图片优化**：使用压缩后的图片
3. **懒加载**：大型文档考虑分页或懒加载

### 安全性

1. **权限控制**：只有管理员可以访问文档管理页面
2. **路径安全**：API会验证文件路径，防止目录遍历攻击
3. **内容过滤**：Markdown渲染时会过滤危险的HTML标签

## ❓ 常见问题

### Q: 为什么我的文档没有显示？

**A:** 请检查：

1. 文件是否在 `docs/` 目录下
2. 文件扩展名是否为 `.md`
3. 文件是否有读取权限

### Q: 如何修改文档分类？

**A:** 系统会根据文档标题自动推断分类。如需修改，可以在标题中添加相应的关键词。

### Q: 文档预览和详情页有什么区别？

**A:**

- **预览**：在弹窗中快速查看，适合浏览多个文档
- **详情页**：完整展示，包含目录导航，适合深度阅读

### Q: 支持哪些Markdown语法？

**A:** 支持标准Markdown语法和GitHub Flavored Markdown (GFM)，包括：

- 表格
- 任务列表
- 删除线
- 代码高亮
- 自动链接

### Q: 如何自定义Markdown样式？

**A:** 可以修改 `MarkdownRenderer.tsx` 组件和对应的CSS文件。

## 🎉 总结

文档管理系统提供了一个简单而强大的方式来管理项目文档。通过直观的界面和丰富的功能，可以帮助团队更好地组织和查找技术文档。

**主要优势：**

- ✅ 自动读取docs目录
- ✅ 智能分类和搜索
- ✅ 实时预览和详情查看
- ✅ 响应式设计和深色模式
- ✅ 无需数据库，直接读取文件系统

开始使用文档管理系统，让你的技术文档管理更加高效！🚀
